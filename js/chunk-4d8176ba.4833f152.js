(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d8176ba"],{"54ca":function(e,t,c){"use strict";c.r(t);var o=c("7a23"),a={class:"text-end mt-5"},n={class:"table-responsive mt-3"},r={class:"table table-hover"},l=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",{style:{width:"120px"}},"分類"),Object(o["createElementVNode"])("th",{style:{width:"400px"}},"產品名稱"),Object(o["createElementVNode"])("th",{style:{width:"150px"},class:"d-none d-sm-table-cell"},"原價"),Object(o["createElementVNode"])("th",{style:{width:"150px"}},"售價"),Object(o["createElementVNode"])("th",{style:{width:"150px"},class:"d-none d-sm-table-cell"},"是否啟用"),Object(o["createElementVNode"])("th",{style:{width:"150px"}},"編輯")])],-1),i={class:"d-none d-sm-table-cell"},d={class:"d-none d-sm-table-cell"},s={key:0,class:"text-success"},u={key:1,class:"text-muted"},m={class:"btn-group btn-group-sm"},p=["onClick"],b=["onClick"];function j(e,t,c,j,O,f){var g=Object(o["resolveComponent"])("Loading"),h=Object(o["resolveComponent"])("Pagination"),v=Object(o["resolveComponent"])("ProductModal"),E=Object(o["resolveComponent"])("DelModal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(g,{isLoading:e.isLoading},null,8,["isLoading"]),Object(o["createElementVNode"])("div",a,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-primary btn-block",onClick:t[0]||(t[0]=function(e){return j.openModal("new")})}," 建立新的產品 ")]),Object(o["createElementVNode"])("div",n,[Object(o["createElementVNode"])("table",r,[l,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.products,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.category),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.title),1),Object(o["createElementVNode"])("td",i,Object(o["toDisplayString"])(e.$filters.dollarSignThousandth(t.origin_price)),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.$filters.dollarSignThousandth(t.price)),1),Object(o["createElementVNode"])("td",d,[1===t.is_enabled?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",s,"啟用")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",u,"未啟用"))]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",m,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-primary",onClick:function(e){return j.openModal("edit",t)}}," 編輯 ",8,p),Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(e){return j.openModal("delete",t)}}," 刪除 ",8,b)])])])})),128))])]),Object(o["createVNode"])(h,{pages:e.pagination,onEmitPage:j.getProducts},null,8,["pages","onEmitPage"]),Object(o["createVNode"])(v,{ref:"productModal",product:e.tempProduct,isNew:e.isNew,onEmitUpdate:j.updateProduct},null,8,["product","isNew","onEmitUpdate"]),Object(o["createVNode"])(E,{ref:"delModal",item:e.tempProduct,onEmitDelete:j.deleteProduct},null,8,["item","onEmitDelete"])])],64)}var O=c("5530"),f=c("1da1"),g=(c("96cf"),c("99af"),c("a434"),c("a4d3"),c("e01a"),{class:"modal fade",tabindex:"-1","aria-hidden":"true",ref:"modal"}),h={class:"modal-dialog modal-xl"},v={class:"modal-content"},E={class:"modal-header bg-primary"},V={key:0,class:"modal-title"},N={key:1,class:"modal-title"},y={class:"modal-body"},k={class:"row"},P={class:"col-sm-4"},w={class:"mb-3"},x=Object(o["createElementVNode"])("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),M={class:"mb-3"},U={key:0,class:"spinner-border text-primary spinner-border-sm me-2",role:"status"},B=Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...",-1),C=[B],D=Object(o["createElementVNode"])("label",{for:"formFile",class:"form-label"},"或 上傳圖片",-1),L=["src"],S={key:0,class:"mt-5"},T=["onUpdate:modelValue"],R=["src"],_=["onClick"],F={key:0},$={class:"col-sm-8"},I={class:"mb-3"},J=Object(o["createElementVNode"])("label",{for:"title",class:"form-label"},"標題",-1),A={class:"row gx-3"},q={class:"col-md-6 mb-3"},z=Object(o["createElementVNode"])("label",{for:"category",class:"form-label"},"分類",-1),G={class:"col-md-6 mb-3"},H=Object(o["createElementVNode"])("label",{for:"unit",class:"form-label"},"單位",-1),K={class:"col-md-6 mb-3"},Q=Object(o["createElementVNode"])("label",{for:"origin_price",class:"form-label"},"原價",-1),W={class:"col-md-6 mb-3"},X=Object(o["createElementVNode"])("label",{for:"price",class:"form-label"},"售價",-1),Y=Object(o["createElementVNode"])("hr",null,null,-1),Z={class:"mb-3"},ee=Object(o["createElementVNode"])("label",{for:"description",class:"form-label"},"產品描述",-1),te={class:"mb-3"},ce=Object(o["createElementVNode"])("label",{for:"content",class:"form-label"},"行程安排",-1),oe={class:"mb-3"},ae=Object(o["createElementVNode"])("label",{for:"condition",class:"form-label"},"成團條件",-1),ne={class:"form-check"},re=Object(o["createElementVNode"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),le={class:"modal-footer"};function ie(e,t,c,a,n,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",g,[Object(o["createElementVNode"])("div",h,[Object(o["createElementVNode"])("div",v,[Object(o["createElementVNode"])("div",E,[c.isNew?(Object(o["openBlock"])(),Object(o["createElementBlock"])("h5",V,"新增產品")):(Object(o["openBlock"])(),Object(o["createElementBlock"])("h5",N,"編輯產品")),Object(o["createElementVNode"])("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=function(){return a.hideModal&&a.hideModal.apply(a,arguments)}),"aria-label":"Close"})]),Object(o["createElementVNode"])("div",y,[Object(o["createElementVNode"])("div",k,[Object(o["createElementVNode"])("div",P,[Object(o["createElementVNode"])("div",w,[x,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"imageUrl",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tempProduct.imageUrl=t})},null,512),[[o["vModelText"],e.tempProduct.imageUrl]])]),Object(o["createElementVNode"])("div",M,[e.loadingStatus?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",U,C)):Object(o["createCommentVNode"])("",!0),D,Object(o["createElementVNode"])("input",{class:"form-control",type:"file",id:"formFile",onChange:t[2]||(t[2]=function(){return a.uploadImage&&a.uploadImage.apply(a,arguments)}),ref:"files"},null,544)]),Object(o["createElementVNode"])("img",{src:e.tempProduct.imageUrl,class:"img-fluid",alt:"產品圖片"},null,8,L),e.tempProduct.imagesUrl?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",S,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.tempProduct.imagesUrl,(function(t,c){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:"mb-3",key:c},[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":function(t){return e.tempProduct.imagesUrl[c]=t}},null,8,T),[[o["vModelText"],e.tempProduct.imagesUrl[c]]]),t?(Object(o["openBlock"])(),Object(o["createElementBlock"])("img",{key:0,src:t,class:"img-fluid",alt:"產品圖片"},null,8,R)):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger mt-3",onClick:function(t){return e.tempProduct.imagesUrl.splice(c,1)}}," 移除 ",8,_)])})),128)),e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]||!e.tempProduct.imagesUrl.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",F,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-primary col-12 mt-3",onClick:t[3]||(t[3]=function(t){return e.tempProduct.imagesUrl.push("")})}," 新增圖片 ")])):Object(o["createCommentVNode"])("",!0)])):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",$,[Object(o["createElementVNode"])("div",I,[J,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.tempProduct.title=t})},null,512),[[o["vModelText"],e.tempProduct.title]])]),Object(o["createElementVNode"])("div",A,[Object(o["createElementVNode"])("div",q,[z,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.tempProduct.category=t})},null,512),[[o["vModelText"],e.tempProduct.category]])]),Object(o["createElementVNode"])("div",G,[H,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.tempProduct.unit=t})},null,512),[[o["vModelText"],e.tempProduct.unit]])]),Object(o["createElementVNode"])("div",K,[Q,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.tempProduct.origin_price=t})},null,512),[[o["vModelText"],e.tempProduct.origin_price,void 0,{number:!0}]])]),Object(o["createElementVNode"])("div",W,[X,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.tempProduct.price=t})},null,512),[[o["vModelText"],e.tempProduct.price,void 0,{number:!0}]])])]),Y,Object(o["createElementVNode"])("div",Z,[ee,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-control",id:"description",rows:"3",placeholder:"請輸入產品描述","onUpdate:modelValue":t[9]||(t[9]=function(t){return e.tempProduct.description=t})},"\n                ",512),[[o["vModelText"],e.tempProduct.description]])]),Object(o["createElementVNode"])("div",te,[ce,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-control",id:"itinerary ",rows:"7",placeholder:"請輸入景點行程","onUpdate:modelValue":t[10]||(t[10]=function(t){return e.tempProduct.content=t})},"\n                ",512),[[o["vModelText"],e.tempProduct.content]])]),Object(o["createElementVNode"])("div",oe,[ae,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-control",id:"condition",rows:"3",placeholder:"請輸入成團條件","onUpdate:modelValue":t[11]||(t[11]=function(t){return e.tempProduct.condition=t})},"\n                ",512),[[o["vModelText"],e.tempProduct.condition]])]),Object(o["createElementVNode"])("div",ne,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",value:"",id:"is_enabled","onUpdate:modelValue":t[12]||(t[12]=function(t){return e.tempProduct.is_enabled=t}),"true-value":1,"false-value":0},null,512),[[o["vModelCheckbox"],e.tempProduct.is_enabled]]),re])])])]),Object(o["createElementVNode"])("div",le,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[13]||(t[13]=function(){return a.hideModal&&a.hideModal.apply(a,arguments)})}," 取消 "),Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[14]||(t[14]=function(t){return a.emitUpdate(e.tempProduct)})}," 確認 ")])])])],512)}var de=c("53cb"),se={props:{product:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},emits:["emit-update"],setup:function(e,t){var c=Object(de["a"])(),a=c.modal,n=c.showModal,r=c.hideModal,l=Object(o["inject"])("axios"),i=Object(o["inject"])("Message"),d=Object(o["reactive"])({tempProduct:{},loadingStatus:!1}),s=Object(o["ref"])(null);function u(){return m.apply(this,arguments)}function m(){return m=Object(f["a"])(regeneratorRuntime.mark((function e(){var t,c,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return d.loadingStatus=!0,t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("starlightselection","/admin/upload"),c=s.value.files[0],o=new FormData,o.append("file-to-upload",c),e.prev=5,e.next=8,l.post(t,o,{headers:{"Content-Type":"multipart/form-data"}});case 8:a=e.sent,a.data.success?(this.tempProduct.imageUrl=a.data.imageUrl,i("success","上傳圖片成功")):i("error","".concat(a.data.message)),d.loadingStatus=!1,e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](5),i(e.t0,"無法上傳圖片，請再次確認!"),d.loadingStatus=!1;case 17:case"end":return e.stop()}}),e,this,[[5,13]])}))),m.apply(this,arguments)}function p(e){t.emit("emit-update",e)}Object(o["watch"])((function(){return e.product}),(function(){d.tempProduct=Object(O["a"])({},e.product),d.tempProduct.imagesUrl||(d.tempProduct.imagesUrl=[]),d.tempProduct.imageUrl||(d.tempProduct.imageUrl="")}));var b=Object(o["toRefs"])(d);return Object(O["a"])(Object(O["a"])({modal:a,showModal:n,hideModal:r},b),{},{emitUpdate:p,files:s,uploadImage:u})}},ue=c("6b0d"),me=c.n(ue);const pe=me()(se,[["render",ie]]);var be=pe,je=c("6ff1"),Oe=c("1799"),fe=c("3a5e"),ge={components:{ProductModal:be,DelModal:je["a"],Loading:fe["a"],Pagination:Oe["a"]},setup:function(){var e=Object(o["inject"])("Message"),t=Object(o["inject"])("axios"),c=Object(o["reactive"])({products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1,currentPage:1}),a=Object(o["ref"])(null),n=Object(o["ref"])(null);function r(){return l.apply(this,arguments)}function l(){return l=Object(f["a"])(regeneratorRuntime.mark((function o(){var a,n,r,l=arguments;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=l.length>0&&void 0!==l[0]?l[0]:1,c.currentPage=a,n="".concat("https://vue3-course-api.hexschool.io","/api/").concat("starlightselection","/admin/products?page=").concat(c.currentPage),c.isLoading=!0,o.prev=4,o.next=7,t.get(n);case 7:r=o.sent,r.data.success?(c.products=r.data.products,c.pagination=r.data.pagination,e("success","產品取得成功")):e("error","".concat(r.data.message)),c.isLoading=!1,o.next=16;break;case 12:o.prev=12,o.t0=o["catch"](4),e("error","無法取得產品，請再次確認!"),c.isLoading=!1;case 16:case"end":return o.stop()}}),o,null,[[4,12]])}))),l.apply(this,arguments)}function i(e,t){"new"===e?(c.isNew=!0,c.tempProduct={},a.value.showModal()):"edit"===e?(c.isNew=!1,c.tempProduct=Object(O["a"])({},t),a.value.showModal()):"delete"===e&&(c.tempProduct=t,n.value.showModal())}function d(e){return s.apply(this,arguments)}function s(){return s=Object(f["a"])(regeneratorRuntime.mark((function o(n){var l,i,d;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return c.tempProduct=n,l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("starlightselection","/admin/product"),i="post",c.isNew||(l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("starlightselection","/admin/product/").concat(c.tempProduct.id),i="put"),c.isLoading=!0,o.prev=5,o.next=8,t[i](l,{data:c.tempProduct});case 8:d=o.sent,d.data.success?(r(c.currentPage),a.value.hideModal(),e("success","".concat(d.data.message))):e("error","".concat(d.data.message)),c.isLoading=!1,o.next=17;break;case 13:o.prev=13,o.t0=o["catch"](5),c.isLoading=!1,e("error","無法修改產品，請再次確認!");case 17:case"end":return o.stop()}}),o,null,[[5,13]])}))),s.apply(this,arguments)}function u(e){return m.apply(this,arguments)}function m(){return m=Object(f["a"])(regeneratorRuntime.mark((function o(a){var l,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("starlightselection","/admin/product/").concat(a),c.isLoading=!0,o.prev=2,o.next=5,t.delete(l);case 5:i=o.sent,i.data.success?(r(c.currentPage),e("success","".concat(i.data.message)),n.value.hideModal()):e("error","".concat(i.data.message)),c.isLoading=!1,o.next=14;break;case 10:o.prev=10,o.t0=o["catch"](2),e("error","無法刪除產品，請再次確認!"),c.isLoading=!1;case 14:case"end":return o.stop()}}),o,null,[[2,10]])}))),m.apply(this,arguments)}r();var p=Object(o["toRefs"])(c);return Object(O["a"])(Object(O["a"])({},p),{},{productModal:a,openModal:i,updateProduct:d,delModal:n,deleteProduct:u,getProducts:r})}};const he=me()(ge,[["render",j]]);t["default"]=he},a434:function(e,t,c){"use strict";var o=c("23e7"),a=c("da84"),n=c("23cb"),r=c("5926"),l=c("07fa"),i=c("7b0b"),d=c("65f0"),s=c("8418"),u=c("1dde"),m=u("splice"),p=a.TypeError,b=Math.max,j=Math.min,O=9007199254740991,f="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var c,o,a,u,m,g,h=i(this),v=l(h),E=n(e,v),V=arguments.length;if(0===V?c=o=0:1===V?(c=0,o=v-E):(c=V-2,o=j(b(r(t),0),v-E)),v+c-o>O)throw p(f);for(a=d(h,o),u=0;u<o;u++)m=E+u,m in h&&s(a,u,h[m]);if(a.length=o,c<o){for(u=E;u<v-o;u++)m=u+o,g=u+c,m in h?h[g]=h[m]:delete h[g];for(u=v;u>v-o+c;u--)delete h[u-1]}else if(c>o)for(u=v-o;u>E;u--)m=u+o-1,g=u+c-1,m in h?h[g]=h[m]:delete h[g];for(u=0;u<c;u++)h[u+E]=arguments[u+2];return h.length=v-o+c,a}})},e01a:function(e,t,c){"use strict";var o=c("23e7"),a=c("83ab"),n=c("da84"),r=c("e330"),l=c("1a2d"),i=c("1626"),d=c("3a9b"),s=c("577e"),u=c("9bf2").f,m=c("e893"),p=n.Symbol,b=p&&p.prototype;if(a&&i(p)&&(!("description"in b)||void 0!==p().description)){var j={},O=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:s(arguments[0]),t=d(b,this)?new p(e):void 0===e?p():p(e);return""===e&&(j[t]=!0),t};m(O,p),O.prototype=b,b.constructor=O;var f="Symbol(test)"==String(p("test")),g=r(b.toString),h=r(b.valueOf),v=/^Symbol\((.*)\)[^)]+$/,E=r("".replace),V=r("".slice);u(b,"description",{configurable:!0,get:function(){var e=h(this),t=g(e);if(l(j,e))return"";var c=f?V(t,7,-1):E(t,v,"$1");return""===c?void 0:c}}),o({global:!0,forced:!0},{Symbol:O})}}}]);
//# sourceMappingURL=chunk-4d8176ba.4833f152.js.map